{
    "resources": {
        "mongo_uri": {"hostname": "localhost", "port": 27017},
        "extcats_uri": {"hostname": "localhost", "port": 27017},
        "catsHTM_uri": {"path", "/path/to/catsHTM/should/be/set"},
        "graphite_uri": {"hostname": "localhost", "port": 2003, "path": "ampel.burst"}
    },
    "channels": {},
    "global": {
        "sources": {
            "ZTFIPAC": {
                "alerts": {
                    "alertHistoryLength": 30,
                    "processing": {
                        "parse": "ampel.pipeline.t0.alerts.ZIAlertParser",
                        "shape": "ampel.pipeline.t0.alerts.ZIAlertShaper",
                        "serialization": "avro"
                    },
                    "flags": [
                        "INST_ZTF",
                        "SRC_IPAC"
                    ],
                    "mappings": {
                        "tranId": "objectId",
                        "pptId": "candid",
                        "obsDate": "jd",
                        "filterId": "fid",
                        "mag": "magpsf"
                    }
                },
                "ingestion": {
                    "class": "ampel.pipeline.t0.ingesters.ZIAlertIngester",
                    "photoShaper": "ampel.pipeline.t0.ingesters.ZIPhotoPointShaper",
                    "checkReprocessing": true,
                    "tranIdPrefix": null
                },
                "flags": {
                    "photo": "INST_ZTF",
                    "main": "INST_ZTF"
                }
            }
        }
    },
    "t0_filters": {
        "BasicFilter": {
            "classFullPath": "ampel.pipeline.t0.filters.BasicFilter"
        },
        "BasicMultiFilter": {
            "classFullPath": "ampel.pipeline.t0.filters.BasicMultiFilter"
        },
        "StripEnvelopeSN": {
            "classFullPath": "ampel.contrib.okc.t0.StripEnvelopeSN",
            "baseConfig": {
                "minDet": 2,
                "minTimeDiff": 30,
                "gMinusR": 0.2
            }
        }
    },
    "t2_run_config": {
        "POLYFIT_advanced": {
            "t2Unit": "POLYFIT",
            "runConfig": "advanced",
            "author": "ztf-software@desy.de",
            "version": 1.0,
            "lastChange": "28.02.2018",
            "private": false,
            "parameters": {
                "degree": 5
            }
        },
        "POLYFIT_default": {
            "t2Unit": "POLYFIT",
            "runConfig": "default",
            "author": "ztf-software@desy.de",
            "version": 1.0,
            "lastChange": "28.02.2018",
            "private": false,
            "parameters": {
                "degree": 3
            }
        },
        "AGN_default": {
            "t2Unit": "AGN",
            "runConfig": "default",
            "author": "ztf-software@desy.de",
            "version": 1.0,
            "lastChange": "28.02.2018",
            "private": false,
            "parameters": {
                "name": "value"
            }
        },
        "PHOTO_Z_default": {
            "t2Unit": "PHOTO_Z",
            "runConfig": "default",
            "author": "ztf-software@desy.de",
            "version": 1.0,
            "lastChange": "28.02.2018",
            "parameters": {
                "name": "value"
            }
        },
        "PHOTO_TYPE_default": {
            "t2Unit": "PHOTO_TYPE",
            "runConfig": "default",
            "author": "ztf-software@desy.de",
            "version": 1.0,
            "lastChange": "28.02.2018",
            "private": false,
            "parameters": {
                "name": "value"
            }
        },
        "SNCOSMO_default": {
            "t2Unit": "SNCOSMO",
            "runConfig": "default",
            "author": "ampel-info@desy.de",
            "version": 1.0,
            "lastChange": "18.03.2018",
            "private": false,
            "parameters": {
                "model": "salt2"
            }
        }
    },
    "t2_units": {
        "SNCOSMO": {
            "classFullPath": "ampel.contrib.hu.t2.T2SNCosmo",
            "version": 1.0,
            "private": false,
            "upperLimits": true,
            "description": {
                "title": "SALT2 template fitting",
                "details": [
                    "This module fits lightcurves using SNCOSMO",
                    "More details later"
                ]
            }
        },
        "AGN": {
            "classFullPath": "ampel.contrib.hu.examples.t2.",
            "version": 1.0,
            "private": false,
            "upperLimits": false,
            "baseConfig": {
                "template": "something"
            },
            "description": {
                "title": "AGN matching",
                "details": [
                    "More details later"
                ]
            }
        },
        "PHOTO_Z": {
            "classFullPath": "ampel.contrib.hu.examples.t2.",
            "version": 1.0,
            "private": false,
            "upperLimits": false,
            "baseConfig": {
                "template": "something"
            },
            "description": {
                "title": "Photo Z",
                "details": [
                    "More details later"
                ]
            }
        },
        "PHOTO_TYPE": {
            "classFullPath": "ampel.contrib.hu.examples.t2.PhotoType",
            "version": 1.0,
            "private": false,
            "upperLimits": false,
            "description": {
                "title": "Photo type",
                "details": [
                    "More details later"
                ]
            }
        },
        "POLYFIT": {
            "classFullPath": "ampel.contrib.hu.examples.t2.T2ExamplePolyFit",
            "author": "ztf-software@desy.de",
            "version": 1.0,
            "private": false,
            "upperLimits": false,
            "baseConfig": {
                "fitFunction": "polyfit"
            },
            "description": {
                "title": "Polynomial fitting",
                "details": [
                    "Fits data using numpy 'polyfit'"
                ]
            }
        }
    },
    "t3_jobs": {
"Slack_publish_1": {
    "active" : false,
    "schedule" :  
        {
            "mode" : "fixed_time",
            "time" : "12:01",
            "timeFormat" : "HH:MM"
        },
    "onError" : {
        "sendMail" : {
            "to" : "ztf-software@desy.de",
            "excStack" : true
        },
        "stopAmpel" : false,
        "retry" : false
    },
    "input" : {
        "select" : {
            "created" : {
                "timeDelta" : {
                    "days" : -40
                }
            },
            "modified" : {
                "timeDelta" : {
                    "days" : -1
                }
            },
            "channel(s)" : [ 
                "HU_SN1", 
                "HU_SN2"
            ],
            "withFlag(s)" : "INST_ZTF",
            "withoutFlag(s)" : "HAS_ERROR"
        },
        "load" : {
            "state" : "latest",
            "doc(s)" : [ 
                "TRANSIENT", 
                "COMPOUND", 
                "T2RECORD"
            ],
            "t2(s)" : [ 
                "SNCOSMO", 
                "AGN"
            ],
            "verbose" : true
        },
        "chunk" : 200
    },
    "task(s)" : [ 
        {
            "name" : "Maurice",
            "t3Unit" : "SLACKPUBLISHER",
            "runConfig" : "hu_sp_1",
            "select" : {
                "channel(s)" : "HU_SN1",
                "state" : "latest",
                "t2(s)" : "SNCOSMO"
            }
        }, 
        {
            "name" : "Fridtjof",
            "t3Unit" : "SLACKPUBLISHER",
            "runConfig" : "hu_sp_2",
            "select" : {
                "channel(s)" : "HU_SN2",
                "state" : "latest",
                "t2(s)" : "AGN"
            }
        }
    ]
},
        "Slack_publish_2": {
            "active": false,
            "schedule": {
                "mode": "fixed_time",
                "time": "12:01"
            },
            "onError": {
                "sendMail": "ztf-software@desy.de",
                "stopAmpel": false,
                "retry": false
            },
            "transients": {
                "select": {
                    "backtime": 1,
                    "channel": "HU_SN2"
                },
                "load": {
                    "state": "latest"
                },
                "chunk_size": 200
            },
            "task": {
                "t3Unit": "SLACKPUBLISHER",
                "runConfig": "HU_SN1_PARAM2"
            }
        },
        "T2_zombies_cleanup": {
            "active": false,
            "schedule": {
                "mode": "fixed_time",
                "time": "12:01"
            },
            "onError": {
                "sendMail": "ztf-software@desy.de",
                "stopAmpel": false,
                "retry": false
            },
            "task": {
                "t3Unit": "T2ZombieCleanUp",
                "runConfig": "hu_zc_1"
            }
        },
        "Slack_publish_test": {
            "active": false,
            "schedule": {
                "mode": "fixed_rate",
                "interval": 1
            },
            "onError": {
                "sendMail": "ztf-software@desy.de",
                "stopAmpel": false,
                "retry": false
            },
            "transients": {
                "select": {
                    "timedelta": {
                        "days": -60
                    },
                    "channel": "HU_SN1",
                    "withFlags": "INST_ZTF",
                    "withoutFlags": "HAS_ERROR"
                },
                "load": {
                    "state": "latest",
                    "t2Results": [
                        "SNCOSMO",
                        "AGN"
                    ]
                },
                "chunk": 200
            },
            "tasks": [
                {
                    "t3Unit": "SLACKPUBLISHER",
                    "runConfig": "hu_sp_1",
                    "subSel": {
                        "channel": "HU_SN1",
                        "state": "latest",
                        "t2Results": "SNCOSMO"
                    }
                }
            ]
        },
        "Slack_publish_sim_test": {
            "active": false,
            "schedule": {
                "mode": "fixed_rate",
                "interval": 1
            },
            "onError": {
                "sendMail": "ampel-info@desy.de",
                "stopAmpel": false,
                "retry": false
            },
            "transients": {
                "select": {
                    "timedelta": {
                        "days": -60
                    },
                    "channel": "HU_SN1",
                    "withFlags": "INST_ZTF",
                    "withoutFlags": "HAS_ERROR"
                },
                "load": {
                    "state": "latest",
                    "t2Results": [
                        "SNCOSMO",
                        "AGN"
                    ]
                },
                "chunk": 200
            },
            "tasks": [
                {
                    "t3Unit": "SLACKPUBLISHER",
                    "runConfig": "hu_sp_1",
                    "subSel": {
                        "channel": "HU_SN1",
                        "state": "latest",
                        "t2Results": "SNCOSMO"
                    }
                }
            ]
        },
        "Slack_publish_demo": {
            "active": false,
            "schedule": {
                "mode": "fixed_rate",
                "interval": 1
            },
            "onError": {
                "sendMail": "ampel-info@desy.de",
                "stopAmpel": false,
                "retry": false
            },
            "transients": {
                "select": {
                    "timedelta": {
                        "days": -60
                    },
                    "channel": "HU_SN1",
                    "withFlags": "INST_ZTF",
                    "withoutFlags": "HAS_ERROR"
                },
                "load": {
                    "state": "latest",
                    "t2Results": [
                        "SNCOSMO",
                        "AGN"
                    ]
                },
                "chunk": 200
            },
            "tasks": [
                {
                    "t3Unit": "SLACKPUBLISHER",
                    "runConfig": "hu_sp_1",
                    "subSel": {
                        "channel": "HU_SN1",
                        "state": "latest",
                        "t2Results": "SNCOSMO"
                    }
                }
            ]
        }
    },
    "t3_run_config": {
        "SLACKPUBLISHER_hu_sp_2": {
            "auth_token": "xoxb-298132201170-O0GcJpOSNYcF84wukZNtcZN8",
            "channel": "ampel_hu_sn2",
            "pos": "brightest",
            "datetime": "%d/%m/%Y %H:%M:%S",
            "version": 1.0
        },
        "SLACKPUBLISHER_hu_sp_1": {
            "auth_token": "xoxb-298132201170-O0GcJpOSNYcF84wukZNtcZN8",
            "msg": "Found following new transient",
            "channel": "ampel_hu_sn1",
            "pos": "brightest",
            "datetime": "%d/%m/%Y %H:%M:%S",
            "version": 1.0
        },
        "PURGE_standard": {
            "inactivity": "30"
        }
    },
    "t3_units": {
        "SLACKPUBLISHER": {
            "classFullPath": "ampel.contrib.hu.t3.SlackPublisher",
            "baseConfig": {
                "url": "http://something",
                "images": false
            }
        },
        "PURGE": {
            "classFullPath": "ampel.contrib.hu.t3.Purge",
            "baseConfig": {
                "s2DB": "url.to.other.mongo.db",
                "login": "bla",
                "pwd": "yo"
            }
        }
    }
}
