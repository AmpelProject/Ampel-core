FROM python:3.8.5

RUN apt-get update && \
    apt-get install -y bash jq && \
    pip install mypy==0.770 mypy2junit

ADD .jenkins/run_mypy.sh /bin

ADD .jenkins /build/.jenkins
RUN cd /build && pip install \
    .jenkins/Ampel-interface

# install dependencies, but not the project itself
ADD setup.py /build/setup.py
RUN cd /build && \
    python setup.py egg_info && \
    pip install `grep -v '^\[' *.egg-info/requires.txt`
